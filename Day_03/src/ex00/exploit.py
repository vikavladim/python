from bs4 import BeautifulSoup


def exploit():
    with open('../../materials/evilcorp.html') as fp:
        soup = BeautifulSoup(fp, 'html.parser')

    soup.title.string.replace_with('Evil Corp - Stealing your money every day')

    name = soup.find('span', 'name').text
    new_h1 = soup.new_tag('h1', string=name + ', you are hacked!')
    soup.body.insert(0, new_h1)

    with open('script.html') as fp:
        script_soup = BeautifulSoup(fp, 'html.parser')
    soup.head.append(script_soup)
    # del soup.form['action']

    soup.a.string.replace_with('Fsociety')
    soup.a['href'] = 'https://mrrobot.fandom.com/wiki/Fsociety'

    with open('../../materials/evilcorp_hacked.html', 'w') as f:
        f.write(str(soup))


if __name__ == '__main__':
    exploit()
